!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=9)}([function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Selector_1=__webpack_require__(2),ComponentConfiguration_1=__webpack_require__(15),ValueAndParent=function(){function e(e,t){this.value=e,this.parent=t}return e}(),UkuleleUtil=function(){function UkuleleUtil(){}return UkuleleUtil.searchHtmlTag=function(e,t){var n="^<"+t+"[\\s\\S]*>[\\s\\S]*</"+t+">$",r=new RegExp(n);return e.search(r)},UkuleleUtil.getInnerHtml=function(e,t){var n="<"+t+"[\\s\\S]*>[\\s\\S]*</"+t+">",r=new RegExp(n),o=e.match(r);if(o.index>-1){var i=o[0],a=i.search(">"),l=i.substr(a+1),u=l.lastIndexOf("</");return l=l.substring(0,u),l=l.replace(/(^\s*)|(\s*$)/g,"")}return null},UkuleleUtil.getComponentConfiguration=function(e){var t=document.createElement("div");t.innerHTML=e;for(var n=Selector_1.Selector.querySelectorAll(t,"template"),r=Selector_1.Selector.querySelectorAll(t,"script"),o=Selector_1.Selector.querySelectorAll(t,"style"),i=[],a=null,l=0;l<r.length;l++){var u=r[l];""!==u.src?i.push(u.src):a=u.innerHTML}return o&&o[0]?new ComponentConfiguration_1.ComponentConfiguration(n[0].innerHTML,i,a,o[0].innerHTML):new ComponentConfiguration_1.ComponentConfiguration(n[0].innerHTML,i,a)},UkuleleUtil.searchUkuAttrTag=function(e){var t=/^uku\-.*/;return e.search(t)},UkuleleUtil.getAttrFromUkuTag=function(e,t){if(void 0===t&&(t=!1),0===UkuleleUtil.searchUkuAttrTag(e)&&(e=e.replace("uku-","")),t){var n=e.split("-");e=n[0];for(var r=1;r<n.length;r++){e=e+n[r].charAt(0).toUpperCase()+n[r].substr(1)}}return e},UkuleleUtil.searchUkuExpTag=function(e){var t=/^\{\{.*\}\}$/;return e.search(t)},UkuleleUtil.searchUkuFuncArg=function(e){var t=/[\+\-\*\/\%\?\:\>\<]/,n=e.search(t);if(-1===n){var r=/\(.*\)$/;return n=e.search(r)}return-1},UkuleleUtil.isRepeat=function(e){return!!e.getAttribute("uku-repeat")},UkuleleUtil.isInRepeat=function(e){for(var t=Selector_1.Selector.parents(e),n=0;n<t.length;n++){var r=t[n];if(9!==r.nodeType){if(r.getAttribute("uku-repeat"))return!0}}return!1},UkuleleUtil.getBoundModelInstantName=function(e){var t=e.split(".")[0];if(t)return t},UkuleleUtil.getBoundModelInstantNames=function(e,t){var n=[];return e.forEach(function(e){var r=new RegExp("\\b"+e,"gm");t.search(r)>-1&&n.push(e)}),n},UkuleleUtil.getFinalValue=function(objects,attrName){return function(){var tempScope={};objects.forEach(function(e){tempScope[e._alias]=e;var t=e._alias,n=new RegExp("\\b"+t+"\\b","gm");attrName=attrName.replace(n,"tempScope."+t);var r=new RegExp("\\.tempScope\\."+t,"gm");attrName=attrName.replace(r,"."+t)});var result=eval(attrName);return tempScope=null,result}()},UkuleleUtil.setFinalValue=function(object,attrName,value){return function(){var tempScope={};attrName=attrName.replace("parent.",""),tempScope[object._alias]=object;var valueString;valueString="string"==typeof value?'"'+value+'"':"object"==typeof value?"JSON.parse('"+JSON.stringify(value)+"')":value;var evalString="tempScope."+attrName+"="+valueString;eval(evalString)}()},UkuleleUtil}();exports.UkuleleUtil=UkuleleUtil},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=n(0),a=function(e){function t(t,n,r,o){var i=e.call(this,t,r,o)||this;return i.ukuTag=n,i}return r(t,e),t.prototype.render=function(e){var t=this.attributeName,n=i.UkuleleUtil.getFinalValue(e,t);"boolean"==typeof n?!0===n?this.element.setAttribute(this.ukuTag,this.ukuTag):this.element.removeAttribute(this.ukuTag):this.element.setAttribute(this.ukuTag,n)},t}(o.BoundItemBase);t.BoundItemAttribute=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.querySelectorAll=function(e,t){return window.hasOwnProperty("jQuery")&&void 0!==window.jQuery?window.jQuery(e).find(t):e.querySelectorAll(t)},e.fuzzyFind=function(e,t){if(e&&e.attributes)for(var n=0;n<e.attributes.length;n++){var r=e.attributes[n];if(r.nodeName.search(t)>-1)return e}return null},e.directText=function(e,t){for(var n="",r=e.childNodes,o=0;o<=r.length-1;o++){var i=r[o];if(3===i.nodeType){if(t||""===t||0===t||!1===t)return void(i.nodeValue=t);n+=i.nodeValue}}return n.trim()},e.parents=function(e){for(var t=[];e.parentNode&&"BODY"!==e.parentNode.tagName;)t.push(e.parentNode),e=e.parentNode;return t},e}();t.Selector=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,n){this.attributeName=e,this.element=t,this.uku=n}return e.prototype.render=function(e){},e}();t.BoundItemBase=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.eventType=e,this.element=t}return e}();t.Event=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.eventsPool={}}return e.prototype.getEventsPool=function(){return this.eventsPool},e.prototype.addListener=function(e,t){this.eventsPool[e]||(this.eventsPool[e]=[]),this.eventsPool[e].push(t)},e.prototype.removeListener=function(e,t){if(this.eventsPool[e])for(var n=this.eventsPool[e].length-1;n>=0;n--)if(this.eventsPool[e][n]===t){this.eventsPool[e].splice(n,1);break}},e.prototype.hasListener=function(e){return!!(this.eventsPool[e]&&this.eventsPool[e].length>0)},e.prototype.dispatchEvent=function(e){if(e&&e.eventType){var t=this.eventsPool[e.eventType];if(t)for(var n=0;n<t.length;n++)t[n].call(this,e)}},e}();t.EventEmitter=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},e.getType=function(t){var n=typeof t;return"object"===n&&e.isArray(t)?"array":n},e.compare=function(t,n){var r=e.getType(t),o=e.getType(n),i=!0;if(r!==o)return!1;switch(r){case"object":if(null===t&&null===n)i=!0;else if(null===t||null===n)i=!1;else{var a=Object.keys(t),l=Object.keys(n);if(a.length!=l.length)i=!1;else if(0===a.length&&0===l.length)i=!0;else for(var u in t){var s=t[u],c=n[u],p=e.compare(s,c);if(!p){i=!1;break}}}break;case"array":if(t.length===n.length)for(var f=0;f<t.length;f++){var d=t[f],h=n[f],_=e.compare(d,h);if(!_){i=!1;break}}else i=!1;break;case"function":i=t.toString()===n.toString();break;default:i=t===n}return i},e.deepClone=function(t){var n,r,o;if("object"!=typeof t||null===t)return t;if(t instanceof Array)for(n=[],r=0,o=t.length;r<o;r++)"object"==typeof t[r]&&null!==t[r]?n[r]=e.deepClone(t[r]):n[r]=t[r];else{n={};for(r in t)"object"==typeof t[r]&&null!==t[r]&&"_dom"!==r?n[r]=e.deepClone(t[r]):n[r]=t[r]}return n},e}();t.ObjectUtil=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.INITIALIZED="initialized",e.REFRESH="refresh",e.HANDLE_ELEMENT_COMPLETED="handle_element_completed",e}();t.UkuEventType=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.addEventListener=function(e,t,n){return window.hasOwnProperty("jQuery")&&void 0!==typeof window.jQuery?window.jQuery(e).on(t,function(e){n&&n(e)}):e.addEventListener(t,n)},e}();t.EventListener=r},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),i=n(10),a=n(16),l=n(17),u=n(2),s=n(7),c=n(4);t.Ukulele=(p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.promiseArray=[],t}return r(t,e),t.prototype.init=function(){var e=this;Promise.all(this.promiseArray).then(function(){e.manageApplication()})},t.prototype.handleElement=function(e){var t=this;this.analyizeElement(e,function(e){t.dispatchEvent(new c.Event(s.UkuEventType.HANDLE_ELEMENT_COMPLETED,e))})},t.prototype.registerController=function(e,t){window[e]=t,this._internal_getDefinitionManager().addControllerDefinition(e,t)},t.prototype.getController=function(e){return this._internal_getDefinitionManager().getControllerDefinition(e).controllerInstance},t.prototype.registerComponent=function(e,t,n){var r=this._internal_getDefinitionManager().addComponentDefinition(e,t,n);this.promiseArray.push(r)},t.prototype.getComponent=function(e){return this._internal_getDefinitionManager().getComponent(e)},t.prototype.getComponentController=function(e){return this._internal_getDefinitionManager().getControllerInstByDomId(e)},t.prototype.refresh=function(e,t){this.dirtyChecker||(this.dirtyChecker=new a.DirtyChecker(this)),this.dirtyChecker.runDirtyChecking(e,t)},t.prototype._internal_getDefinitionManager=function(){return this.defMgr||(this.defMgr=new i.DefinitionManager(this)),this.defMgr},t.prototype._internal_dealWithElement=function(e,t){this.analyizeElement(e,t)},t.prototype.manageApplication=function(){var e=this,t=u.Selector.querySelectorAll(document,"[uku-application]");if(1!==t.length)throw new Error("Only one 'uku-application' can be declared in a whole html.");this.analyizeElement(t[0],function(t){e.dispatchEvent(new c.Event(s.UkuEventType.INITIALIZED,t))})},t.prototype.analyizeElement=function(e,t){var n=new l.Analyzer(this);t&&function(e){n.addListener(l.Analyzer.ANALYIZE_COMPLETED,function(t){e(t.element)})}(t),n.analyizeElement(e)},t}(o.EventEmitter),p.INITIALIZED="initialized",p.REFRESH="refresh",p.HANDLE_ELEMENT_COMPLETED="handle_element_completed",p);var p},function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,l)}u((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,l,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l};Object.defineProperty(exports,"__esModule",{value:!0});var ObjectUtil_1=__webpack_require__(6),Ajax_1=__webpack_require__(11),ControllerModel_1=__webpack_require__(12),ComponentModel_1=__webpack_require__(13),ComponentPoolItem_1=__webpack_require__(14),UkuleleUtil_1=__webpack_require__(0),DefinitionManager=function(){function DefinitionManager(e){this.controllersDefinition={},this.componentsDefinition={},this.componentsPool={},this.copyControllers={},this.dependentScriptsCache={},this.ajax=new Ajax_1.Ajax,this.uku=e}return DefinitionManager.prototype.getComponentsDefinition=function(){return this.componentsDefinition},DefinitionManager.prototype.getComponentsPool=function(){return this.componentsPool},DefinitionManager.prototype.setComponentsPool=function(e){this.componentsPool=e},DefinitionManager.prototype.setComponentsDefinition=function(e){this.componentsDefinition=e},DefinitionManager.prototype.getComponentDefinition=function(e){return this.componentsDefinition[e]},DefinitionManager.prototype.getControllerDefinition=function(e){return this.controllersDefinition[e]},DefinitionManager.prototype.getControllersDefinition=function(){return this.controllersDefinition},DefinitionManager.prototype.getComponent=function(e){return this.componentsPool[e]},DefinitionManager.prototype.getCopyControllers=function(){return this.copyControllers},DefinitionManager.prototype.copyAllController=function(){for(var e in this.controllersDefinition){var t=this.controllersDefinition[e],n=t.controllerInstance;this.copyControllerInstance(n,e)}},DefinitionManager.prototype.copyControllerInstance=function(e,t){var n=ObjectUtil_1.ObjectUtil.deepClone(e);delete this.copyControllers[t],this.copyControllers[t]=n},DefinitionManager.prototype.addControllerDefinition=function(e,t){var n=new ControllerModel_1.ControllerModel(e,t);t._alias=e,this.controllersDefinition[e]=n},DefinitionManager.prototype.getControllerInstByDomId=function(e){for(var t in this.controllersDefinition){var n=this.controllersDefinition[t],r=n.controllerInstance;if(r._dom&&r._dom.id===e)return r}},DefinitionManager.prototype.addComponentDefinition=function(e,t,n){var r=this;return new Promise(function(o,i){if(n)return r.componentsPool[e]=new ComponentPoolItem_1.ComponentPoolItem(e,t,!1),r.ajax.get(t).then(function(t){var n=UkuleleUtil_1.UkuleleUtil.getComponentConfiguration(t);return r.analyizeComponent(e,n)});r.componentsPool[e]=new ComponentPoolItem_1.ComponentPoolItem(e,t,!0),o()})},DefinitionManager.prototype.addLazyComponentDefinition=function(e,t){var n=this;return new Promise(function(r,o){return n.ajax.get(t).then(function(o){var i=UkuleleUtil_1.UkuleleUtil.getComponentConfiguration(o);return n.analyizeComponent(e,i).then(function(){n.componentsPool[e]={tagName:e,templateUrl:t,lazy:!1},r()})})})},DefinitionManager.prototype.getBoundAttributeValue=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this.getControllerModelByName(e),o=[];r.forEach(function(e){o.push(e.controllerInstance)});var i=[this.uku,o,e];return i=i.concat(t),UkuleleUtil_1.UkuleleUtil.getFinalValue.apply(null,i)},DefinitionManager.prototype.getControllerModelByName=function(e){return this.getBoundControllerModelByName(e)},DefinitionManager.prototype.getFinalValueByExpression=function(e){var t=this.getControllerModelByName(e),n=[];return t.forEach(function(e){n.push(e.controllerInstance)}),UkuleleUtil_1.UkuleleUtil.getFinalValue(n,e)},DefinitionManager.prototype.getBoundControllerModelByName=function(e){var t,n,r=this,o=[];if(-1!==e.search("parent.")){var i=this.uku.parentUku._internal_getDefinitionManager();t=Object.keys(i.controllersDefinition),n=UkuleleUtil_1.UkuleleUtil.getBoundModelInstantNames(t,e),n.forEach(function(e){var t=i.controllersDefinition[e];o.push(t)})}else t=Object.keys(this.controllersDefinition),n=UkuleleUtil_1.UkuleleUtil.getBoundModelInstantNames(t,e),n.forEach(function(e){var t=r.controllersDefinition[e];o.push(t)});return o},DefinitionManager.prototype.analyizeComponent=function(e,t){return __awaiter(this,void 0,void 0,function(){function n(e){return new Promise(function(t,n){if(o.dependentScriptsCache[e])t();else{var r=document.getElementsByTagName("HEAD")[0],i=document.createElement("script");i.type="text/javascript",i.charset="utf-8",i.async=!0,i.src=e,i.onload=function(e){o.dependentScriptsCache[e.target.src]=!0,t()},r.appendChild(i)}})}var r,o,i,a,l,u,s;return __generator(this,function(c){switch(c.label){case 0:return r=t.dependentScripts,(o=this,r&&r.length>0)?(i=void 0,"function"==typeof window.define&&window.define.amd&&(i=window.define,window.define=void 0),t.componentControllerScript?[3,2]:(a=r[r.length-1],l=t,[4,this.ajax.get(a)])):[3,7];case 1:l.componentControllerScript=c.sent(),r.pop(),c.label=2;case 2:u=0,c.label=3;case 3:return u<r.length?(s=r[u],[4,n(s)]):[3,6];case 4:c.sent(),c.label=5;case 5:return u++,[3,3];case 6:return i&&(window.define=i),this.buildeComponentModel(e,t.template,t.componentControllerScript,t.stylesheet),[2];case 7:return this.buildeComponentModel(e,t.template,t.componentControllerScript,t.stylesheet),[2];case 8:return[2]}})})},DefinitionManager.prototype.buildeComponentModel=function(tag,template,script,style){function dealWithShadowStyle(e,t){var n=document.getElementsByTagName("HEAD")[0],r=document.createElement("style");r.type="text/css";var o=t.split("}"),i=[];o.forEach(function(e,t){var n=e.replace(/^\s*/,"");n&&i.push(n)}),t=i.join("}\n."+e+" "),t="."+e+" "+t+"}",r.innerHTML=t,n.appendChild(r)}var debugComment="//# sourceURL="+tag+".js";try{var controllerClazz=void 0;script&&(script+=debugComment,controllerClazz=eval(script));var newComp=new ComponentModel_1.ComponentModel(tag,template,controllerClazz);this.componentsDefinition[tag]=newComp,style&&dealWithShadowStyle(tag,style)}catch(e){console.error(e)}},DefinitionManager}();exports.DefinitionManager=DefinitionManager},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.get=function(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.onreadystatechange=function(){4===r.readyState&&(200===r.status?t(r.responseText):n())},r.open("GET",e,!0),r.send(null)})},e}();t.Ajax=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.alias=e,this.controllerInstance=t,this.boundItems=[]}return e.prototype.addBoundItem=function(e){this.boundItems.push(e)},e.prototype.getBoundItemsByName=function(e){for(var t=[],n=0;n<this.boundItems.length;n++){var r=this.boundItems[n];r.attributeName===e&&t.push(r)}return t},e}();t.ControllerModel=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,n){this.tagName=e,this.template=t,this.controllerClazz=n}return e}();t.ComponentModel=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,n){this.tagName=e,this.templateUrl=t,this.lazy=n}return e}();t.ComponentPoolItem=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,n,r){void 0===r&&(r=void 0),this.template=e,this.dependentScripts=t,this.componentControllerScript=n,this.stylesheet=r}return e}();t.ComponentConfiguration=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(6),i=n(7),a=n(4),l=function(){function e(e){this.uku=e,this.defMgr=this.uku._internal_getDefinitionManager()}return e.prototype.runDirtyChecking=function(e,t){function n(e){var n=l.defMgr.getControllersDefinition()[e];if(!n)return void(l.uku.parentUku&&l.uku.parentUku.refresh(e));for(var u=n.controllerInstance,s=l.defMgr.getCopyControllers()[e],c=0,p=0;p<n.boundItems.length;p++){var f=n.boundItems[p],d=f.attributeName;if(s){f.hasOwnProperty("ukuTag")&&"selected"===f.ukuTag&&(d=d.split("|")[0]);var h=r.UkuleleUtil.getFinalValue([u],d),_=r.UkuleleUtil.getFinalValue([s],d);if(!o.ObjectUtil.compare(_,h)){d=f.attributeName;for(var m=n.getBoundItemsByName(d),v=0;v<m.length;v++){var y=m[v];(y.element!==t||f.hasOwnProperty("ukuTag")&&"value"!==y.ukuTag)&&(c++,y.render([u]))}}}}c>0&&l.uku.hasListener(i.UkuEventType.REFRESH)&&l.uku.dispatchEvent(new a.Event(i.UkuEventType.REFRESH)),l.defMgr.copyControllerInstance(u,e)}var l=this;if(e){if("string"==typeof e)n(e);else if(o.ObjectUtil.isArray(e))for(var u=0;u<e.length;u++)n(e[u])}else for(var s in this.defMgr.getControllersDefinition())n(s)},e}();t.DirtyChecker=l},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),__awaiter=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,l)}u((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,l,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l};Object.defineProperty(exports,"__esModule",{value:!0});var EventEmitter_1=__webpack_require__(5),UkuleleUtil_1=__webpack_require__(0),BoundItemAttributeFactory_1=__webpack_require__(18),BoundItemExpression_1=__webpack_require__(27),BoundItemInnerText_1=__webpack_require__(28),BoundItemRepeat_1=__webpack_require__(29),BoundItemComponentAttribute_1=__webpack_require__(30),ElementActionBinder_1=__webpack_require__(31),EventListener_1=__webpack_require__(8),Selector_1=__webpack_require__(2),Event_1=__webpack_require__(4),Analyzer=function(_super){function Analyzer(e){var t=_super.call(this)||this;return t.dealWithAttribute=function(e,t){var n=this,r=e.getAttribute("uku-"+t),o=this.defMgr.getControllerModelByName(r);if(o&&o.length>0){var i=BoundItemAttributeFactory_1.BoundItemAttributeFactory.getInstance().generateInstance(r,t,e,this.uku),a=[];o.forEach(function(r){r.addBoundItem(i),ElementActionBinder_1.elementChangedBinder(e,t,r,n.uku.refresh,n.uku),a.push(r.controllerInstance)}),i.render(a)}},t.uku=e,t.defMgr=t.uku._internal_getDefinitionManager(),t}return __extends(Analyzer,_super),Analyzer.prototype.analyizeElement=function(e){var t=this;this.searchComponent(e).then(function(e){t.searchExpression(e),t.searchUkuAttribute(e),t.defMgr.copyAllController(),t.hasListener(Analyzer.ANALYIZE_COMPLETED)&&t.dispatchEvent(new Event_1.Event(Analyzer.ANALYIZE_COMPLETED,e))})},Analyzer.prototype.sortAttributes=function(e){for(var t=[],n=[],r=0;r<e.attributes.length;r++){var o=e.attributes[r];-1!==o.nodeName.search("uku-on")?n.push(o):t.push(o)}return t=t.concat(n)},Analyzer.prototype.searchUkuAttribute=function(e){var t=[],n=Selector_1.Selector.fuzzyFind(e,"uku-");n&&t.push(n);for(var r=Selector_1.Selector.querySelectorAll(e,"*"),o=0;o<r.length;o++){var i=r[o],a=Selector_1.Selector.fuzzyFind(i,"uku-");a&&!UkuleleUtil_1.UkuleleUtil.isInRepeat(a)&&t.push(a)}for(var l=0;l<t.length;l++)for(var u=t[l],s=this.sortAttributes(u),c=0;c<s.length;c++){var p=s[c];if(UkuleleUtil_1.UkuleleUtil.searchUkuAttrTag(p.nodeName)>-1){var f=p.nodeName.split("-");f.shift();var d=f.join("-");"application"!==d&&(0===d.search("on")?UkuleleUtil_1.UkuleleUtil.isRepeat(u)||UkuleleUtil_1.UkuleleUtil.isInRepeat(u)||this.dealWithEvent(u,d):-1!==d.search("repeat")?this.dealWithRepeat(u):UkuleleUtil_1.UkuleleUtil.isRepeat(u)||UkuleleUtil_1.UkuleleUtil.isInRepeat(u)||("text"!==d?this.dealWithAttribute(u,d):this.dealWithInnerText(u)))}}},Analyzer.prototype.searchComponent=function(e){return __awaiter(this,void 0,void 0,function(){var t,n,r,n,r,o,i;return __generator(this,function(a){switch(a.label){case 0:return(t=this.defMgr.getComponent(e.localName))?t.lazy?[3,1]:(n=e.attributes,r=this.defMgr.getComponentsDefinition()[t.tagName],UkuleleUtil_1.UkuleleUtil.isRepeat(e)||UkuleleUtil_1.UkuleleUtil.isInRepeat(e)?[2,e]:[2,this.dealWithComponent(e,r.template,r.controllerClazz,n)]):[3,4];case 1:return[4,this.defMgr.addLazyComponentDefinition(t.tagName,t.templateUrl)];case 2:return a.sent(),n=e.attributes,r=this.defMgr.getComponentsDefinition()[t.tagName],UkuleleUtil_1.UkuleleUtil.isRepeat(e)||UkuleleUtil_1.UkuleleUtil.isInRepeat(e)?[2,e]:[2,this.dealWithComponent(e,r.template,r.controllerClazz,n)];case 3:return[3,10];case 4:if(!(e.children&&e.children.length>0))return[3,9];o=0,a.label=5;case 5:return o<e.children.length?(i=e.children[o],[4,this.searchComponent(i)]):[3,8];case 6:a.sent(),a.label=7;case 7:return o++,[3,5];case 8:case 9:return[2,e];case 10:return[2]}})})},Analyzer.prototype.dealWithComponent=function(e,t,n,r){return __awaiter(this,void 0,void 0,function(){var o,i,a,l,u,s,c,c,p,f,d;return __generator(this,function(h){switch(h.label){case 0:if(o="cc_"+Math.floor(1e4*Math.random()).toString(),t=t.replace(new RegExp("'cc\\.","gm"),"'"+o+"."),t=t.replace(new RegExp('"cc\\.',"gm"),'"'+o+"."),t=t.replace(new RegExp("{{cc\\.","gm"),"{{"+o+"."),t=t.replace(new RegExp(" cc\\.","gm")," "+o+"."),t=t.replace(new RegExp("\\(cc\\.","gm"),"("+o+"."),t=t.replace(new RegExp("\\,cc\\.","gm"),","+o+"."),t=t.replace(new RegExp("\\.cc\\.","gm"),"."+o+"."),t=t.replace(new RegExp("\\!cc\\.","gm"),"!"+o+"."),i=document.createElement("div"),i.insertAdjacentHTML("afterBegin",t),i.children.length>1&&(t=i.outerHTML),e.insertAdjacentHTML("beforeBegin",t),a=e.previousElementSibling,a.classList.add(e.localName),n)for(l=new n(this.uku),l._dom=a,l.fire=function(e,t,n,r){void 0===n&&(n=!1),void 0===r&&(r=!0);var o=new CustomEvent(e.toLowerCase(),{bubbles:n,cancelable:r});o.data=t,l._dom.dispatchEvent(o)},this.uku.registerController(o,l),u=function(e){var t=r[e];if(0!==UkuleleUtil_1.UkuleleUtil.searchUkuAttrTag(t.nodeName)||-1!==t.nodeName.search("uku-on")||"uku-render"===t.nodeName||"uku-visible"===t.nodeName)a.setAttribute(t.nodeName,t.nodeValue);else{var n=UkuleleUtil_1.UkuleleUtil.getAttrFromUkuTag(t.nodeName,!0),o=s.defMgr.getControllerModelByName(t.nodeValue);if(o&&o.length>0){var i=new BoundItemComponentAttribute_1.BoundItemComponentAttribute(t.nodeValue,n,l,s.uku),u=[];o.forEach(function(e){e.addBoundItem(i),u.push(e.controllerInstance)}),i.render(u)}}},s=this,c=0;c<r.length;c++)u(c);else for(c=0;c<r.length;c++)p=r[c],0===UkuleleUtil_1.UkuleleUtil.searchUkuAttrTag(p.nodeName)&&-1===p.nodeName.search("uku-on")&&"uku-render"!==p.nodeName&&"uku-visible"!==p.nodeName||a.setAttribute(p.nodeName,p.nodeValue);if(e.parentNode.removeChild(e),!(a.children&&a.children.length>0))return[3,5];f=0,h.label=1;case 1:return f<a.children.length?(d=a.children[f],[4,this.searchComponent(d)]):[3,4];case 2:h.sent(),h.label=3;case 3:return f++,[3,1];case 4:case 5:return l&&l._initialized&&"function"==typeof l._initialized&&l._initialized(o,l._dom),[2,a]}})})},Analyzer.prototype.searchExpression=function(e){-1!==UkuleleUtil_1.UkuleleUtil.searchUkuExpTag(Selector_1.Selector.directText(e))&&(UkuleleUtil_1.UkuleleUtil.isRepeat(e)||UkuleleUtil_1.UkuleleUtil.isInRepeat(e)||this.dealWithExpression(e));for(var t=0;t<e.children.length;t++)this.searchExpression(e.children[t])},Analyzer.prototype.dealWithExpression=function(e){var t=Selector_1.Selector.directText(e);if(-1!==UkuleleUtil_1.UkuleleUtil.searchUkuExpTag(t)){var n=t.slice(2,-2),r=this.defMgr.getControllerModelByName(n);if(r&&r.length>0){var o=new BoundItemExpression_1.BoundItemExpression(n,t,e,this.uku),i=[];r.forEach(function(e){e.addBoundItem(o),i.push(e.controllerInstance)}),o.render(i)}}},Analyzer.prototype.dealWithInnerText=function(e){var t=e.getAttribute("uku-text");if(t){var n=this.defMgr.getControllerModelByName(t);if(n&&n.length>0){var r=new BoundItemInnerText_1.BoundItemInnerText(t,e,this.uku),o=[];n.forEach(function(e){e.addBoundItem(r),o.push(e.controllerInstance)}),r.render(o)}}},Analyzer.prototype.dealWithEvent=function(element,eventName){var _this=this,expression=element.getAttribute("uku-"+eventName),eventNameInListener=eventName.substring(2);eventNameInListener=eventNameInListener.toLowerCase();var controllerModels=this.defMgr.getControllerModelByName(expression);controllerModels&&0!==controllerModels.length||(controllerModels=[]),EventListener_1.EventListener.addEventListener(element,eventNameInListener,function(event){var alias_list=[];controllerModels.forEach(function(e){_this.defMgr.copyControllerInstance(e.controllerInstance,controllerModels.alias),alias_list.push(e.alias)});var index=UkuleleUtil_1.UkuleleUtil.searchUkuFuncArg(expression);if(-1===index){var handler=new Function("event","return "+expression);console.log(handler.toString()),handler(event)}else{var i=expression.search(/\(/),arg="event";")"!==expression[i+1]&&(arg="event,");var arr=expression.split("(");arr[1]=arg+arr[1];var new_expression_1=arr.join("(");!function(e){var tempScope={};tempScope.event=e,eval(new_expression_1),tempScope=null}(event)}_this.uku.refresh(alias_list,element)})},Analyzer.prototype.dealWithRepeat=function(e){var t=e.getAttribute("uku-repeat"),n=t.split(" in "),r=n[0],o=n[1],i=this.defMgr.getControllerModelByName(o);if(i&&i.length>0){var a=[],l=new BoundItemRepeat_1.BoundItemRepeat(o,r,e,this.uku);i.forEach(function(e){e.addBoundItem(l),a.push(e.controllerInstance)}),l.render(a)}},Analyzer.ANALYIZE_COMPLETED="analyizeCompleted",Analyzer}(EventEmitter_1.EventEmitter);exports.Analyzer=Analyzer},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),o=n(20),i=n(21),a=n(22),l=n(23),u=n(24),s=n(25),c=n(26),p=n(1),f=function(){function e(){if(e._instance)throw new Error("Error: Instantiation failed: Use BoundItemAttributeFactory.getInstance() instead of new.");e._instance=this}return e.getInstance=function(){return e._instance},e.prototype.generateInstance=function(e,t,n,f){var d;switch(t){case"selected":d=new r.BountItemAttrSelected(e,t,n,f);break;case"data-item":d=new o.BoundItemAttrDataItem(e,t,n,f);break;case"src":d=new i.BoundItemAttrSrc(e,t,n,f);break;case"disabled":d=new a.BoundItemAttrDisabled(e,t,n,f);break;case"render":d=new l.BoundItemAttrRender(e,t,n,f);break;case"style":d=new u.BoundItemAttrStyle(e,t,n,f);break;case"value":d=new s.BoundItemAttrValue(e,t,n,f);break;case"visible":d=new c.BoundItemAttrVisible(e,t,n,f);break;default:d=new p.BoundItemAttribute(e,t,n,f)}return d},e._instance=new e,e}();t.BoundItemAttributeFactory=f},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),i=n(0),a=function(e){function t(t,n,r,o){if("selected"!==n)throw new TypeError("it doesn't use uku-selected");return e.call(this,t,n,r,o)||this}return r(t,e),t.prototype.render=function(e){var t,n=this.attributeName,r=this.element.tagName;if("SELECT"===r){var o=this.attributeName.split("|");n=o[0],t=o[1];var a=i.UkuleleUtil.getFinalValue(e,n),l=void 0;l=t?a[t]:a,this.element.value=l}if("INPUT"===r&&"radio"===this.element.getAttribute("type")){var a=i.UkuleleUtil.getFinalValue(e,n);this.element.value===a&&this.element.setAttribute("checked","true")}},t}(o.BoundItemAttribute);t.BountItemAttrSelected=a},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),i=n(0),a=function(e){function t(t,n,r,o){if("data-item"!==n)throw new TypeError("it doesn't use uku-item");return e.call(this,t,n,r,o)||this}return r(t,e),t.prototype.render=function(e){var t=this.attributeName,n=this.element.tagName,r=i.UkuleleUtil.getFinalValue(e,t);"OPTION"===n&&(r=JSON.stringify(r),this.element.setAttribute("data-item",r))},t}(o.BoundItemAttribute);t.BoundItemAttrDataItem=a},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),i=n(0),a=function(e){function t(t,n,r,o){if("src"!==n)throw new TypeError("it doesn't use uku-src");return e.call(this,t,n,r,o)||this}return r(t,e),t.prototype.render=function(e){var t=this.attributeName,n=this.element.tagName,r=i.UkuleleUtil.getFinalValue(e,t);if("IMG"!==n&&"VIDEO"!==n&&"AUDIO"!==n)throw new Error("uku-src doesn't work with current dom");r&&this.element.setAttribute(this.ukuTag,r)},t}(o.BoundItemAttribute);t.BoundItemAttrSrc=a},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),i=n(0),a=function(e){function t(t,n,r,o){if("disabled"!==n)throw new TypeError("it doesn't use uku-disabled");return e.call(this,t,n,r,o)||this}return r(t,e),t.prototype.render=function(e){var t=this.attributeName,n=(this.element.tagName,i.UkuleleUtil.getFinalValue(e,t));this.element.disabled=n},t}(o.BoundItemAttribute);t.BoundItemAttrDisabled=a},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),i=n(0),a=function(e){function t(t,n,r,o){if("render"!==n)throw new TypeError("it doesn't use uku-render");return e.call(this,t,n,r,o)||this}return r(t,e),t.prototype.render=function(e){var t=this.attributeName;this.element.tagName;if(i.UkuleleUtil.getFinalValue(e,t)){var n=this.element.getAttribute("data-old-display");null!==n&&(this.element.style.display=n)}else{var n=this.element.getAttribute("data-old-display");null===n&&(n=this.element.style.display,this.element.setAttribute("data-old-display",n)),this.element.style.display="none"}},t}(o.BoundItemAttribute);t.BoundItemAttrRender=a},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),i=n(0),a=function(e){function t(t,n,r,o){if("style"!==n)throw new TypeError("it doesn't use uku-style");return e.call(this,t,n,r,o)||this}return r(t,e),t.prototype.render=function(e){var t=this.attributeName,n=(this.element.tagName,i.UkuleleUtil.getFinalValue(e,t));for(var r in n)this.element.style[r]=n[r]},t}(o.BoundItemAttribute);t.BoundItemAttrStyle=a},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),i=n(0),a=function(e){function t(t,n,r,o){if("value"!==n)throw new TypeError("it doesn't use uku-value");return e.call(this,t,n,r,o)||this}return r(t,e),t.prototype.render=function(e){var t=this.attributeName,n=this.element.tagName,r=i.UkuleleUtil.getFinalValue(e,t);"INPUT"===n&&"checkbox"===this.element.getAttribute("type")?this.element.checked=r:this.element.value=r},t}(o.BoundItemAttribute);t.BoundItemAttrValue=a},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),i=n(0),a=function(e){function t(t,n,r,o){if("visible"!==n)throw new TypeError("it doesn't use uku-visible");return e.call(this,t,n,r,o)||this}return r(t,e),t.prototype.render=function(e){var t=this.attributeName,n=(this.element.tagName,i.UkuleleUtil.getFinalValue(e,t));this.element.style.visibility=n?"visible":"hidden"},t}(o.BoundItemAttribute);t.BoundItemAttrVisible=a},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=n(0),a=n(2),l=function(e){function t(t,n,r,o){var i=e.call(this,t,r,o)||this;return i.expression=n,i}return r(t,e),t.prototype.render=function(e){var t=i.UkuleleUtil.getFinalValue(e,this.attributeName);a.Selector.directText(this.element,t)},t}(o.BoundItemBase);t.BoundItemExpression=l},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=n(0),a=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.tagName="text",o}return r(t,e),t.prototype.render=function(e){var t=i.UkuleleUtil.getFinalValue(e,this.attributeName);this.element.innerHTML=t},t}(o.BoundItemBase);t.BoundItemInnerText=a},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=n(0),a=function(e){function t(t,n,r,o){var i=e.call(this,t,r,o)||this;return i.expression=n,i.renderTemplate=r.outerHTML,i.parentElement=r.parentNode,i.beginCommentString=void 0,i.endCommentString=void 0,i}return r(t,e),t.prototype.render=function(e){function t(){var e=i.UkuleleUtil.searchHtmlTag(o.renderTemplate,"tr"),t=i.UkuleleUtil.searchHtmlTag(o.renderTemplate,"th");return-1===e||-1===t?document.createElement("tbody"):document.createElement("div")}var n=this,r=i.UkuleleUtil.getFinalValue(e,this.attributeName);if(r){var o=this;if(this.element&&this.element.parentNode){this.beginCommentString="begin uku-repeat: "+this.expression+" in "+this.attributeName;var a=document.createComment(this.beginCommentString);this.element.parentNode.insertBefore(a,this.element),this.endCommentString="end uku-repeat: "+this.expression+" in "+this.attributeName;var l=document.createComment(this.endCommentString);this.element.parentNode.insertBefore(l,this.element.nextSibling),this.element.parentNode.removeChild(this.element)}var u={acceptNode:function(e){return e.nodeValue===o.beginCommentString?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}},s=u.acceptNode;s.acceptNode=u.acceptNode;for(var c=document.createTreeWalker(this.parentElement,NodeFilter.SHOW_COMMENT,s,!1);c.nextNode();){var p=c.currentNode;if(p&&p.nodeValue===this.beginCommentString){for(;p.nextSibling&&p.nextSibling.nodeValue!==this.endCommentString;)p.parentNode.removeChild(p.nextSibling);var f=t(),d=t();p.parentNode.insertBefore(d,p.nextSibling);for(var h=0;h<r.length;h++)if(f.insertAdjacentHTML("beforeEnd",this.renderTemplate),h===r.length-1){var _=f.innerHTML;d.insertAdjacentHTML("beforeBegin",_),p.parentNode.removeChild(d),f=null,d=null}for(var m=p.nextElementSibling,v=0;v<r.length;v++){m.removeAttribute("uku-repeat");var y=this.uku.constructor,g=new y;g.parentUku=this.uku;var b=g.parentUku._internal_getDefinitionManager().getComponentsDefinition(),k=g.parentUku._internal_getDefinitionManager().getComponentsPool();g._internal_getDefinitionManager().setComponentsDefinition(b),g._internal_getDefinitionManager().setComponentsPool(k);var U=m.nextSibling,w=typeof r[v],E="repeatItem_"+Math.floor(1e4*Math.random()).toString()+"_"+this.expression;"object"===w?g.registerController(E,r[v]):(g.registerController(E,{value:r[v]}),E+=".value");var C=new RegExp("\\b"+this.expression+"(?!\\-|\\s|\\w|\\=)","gm"),A=m.outerHTML.replace(C,E);m.insertAdjacentHTML("afterend",A);var M=m.nextSibling;m.parentNode.removeChild(m),m=M,g._internal_dealWithElement(m,function(e){if("OPTION"===n.element.tagName){var t=n.parentElement.getAttribute("uku-selected"),r=t.split("|");t=r[0];var o=r[1],i=n.uku._internal_getDefinitionManager().getFinalValueByExpression(t);n.parentElement.value=o?i[o]:i}}),m=U}}}}},t}(o.BoundItemBase);t.BoundItemRepeat=a},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=n(0),a=function(e){function t(t,n,r,o){var i=e.call(this,t,null,o)||this;return i.ukuTag=n,i.componentController=r,i}return r(t,e),t.prototype.render=function(e){var t=i.UkuleleUtil.getFinalValue(e,this.attributeName);this.componentController[this.ukuTag]=t,this.uku.refresh(this.componentController._alias)},t}(o.BoundItemBase);t.BoundItemComponentAttribute=a},function(e,t,n){"use strict";function r(e,t,n,r,i){for(var c=[o,a,l,u,s],p=0;p<c.length;p++){if(c[p].apply(this,arguments))break}}function o(e,t,n,r,o){if("INPUT"===e.tagName&&i(e)&&"value"===t){var a="change",l=e.getAttribute("type");return"text"!==l&&"text"!==l&&"password"!==l&&"tel"!==l&&"number"!==l&&"search"!==l||(a="input"),p.EventListener.addEventListener(e,a,function(i){var a=e.getAttribute("uku-"+t);c.UkuleleUtil.setFinalValue(n.controllerInstance,a,e.value),r&&r.call(o,n.alias,e)}),!0}return!1}function i(e){var t=e.getAttribute("type");return"checkbox"!==t&&"radio"!==t}function a(e,t,n,r,o){return"TEXTAREA"===e.tagName&&"value"===t&&(p.EventListener.addEventListener(e,"input",function(i){var a=e.getAttribute("uku-"+t);c.UkuleleUtil.setFinalValue(n.controllerInstance,a,e.value),r&&r.call(o,n.alias,e)}),!0)}function l(e,t,n,r,o){return"SELECT"===e.tagName&&"selected"===t&&(p.EventListener.addEventListener(e,"change",function(i){var a=e.getAttribute("uku-"+t);a=a.split("|")[0];for(var l=f.Selector.querySelectorAll(e,"option"),u=0;u<l.length;u++){var s=l[u];if(s.selected){var p=JSON.parse(s.getAttribute("data-item"));c.UkuleleUtil.setFinalValue(n.controllerInstance,a,p)}}r&&r.call(o,n.alias,e)}),!0)}function u(e,t,n,r,o){return"INPUT"===e.tagName&&"value"===t&&"checkbox"===e.getAttribute("type")&&(p.EventListener.addEventListener(e,"change",function(i){var a=e.getAttribute("uku-"+t);c.UkuleleUtil.setFinalValue(n.controllerInstance,a,e.checked),r&&r.call(o,n.alias,e)}),!0)}function s(e,t,n,r,o){return"INPUT"===e.tagName&&"selected"===t&&"radio"===e.getAttribute("type")&&(p.EventListener.addEventListener(e,"change",function(i){var a=e.getAttribute("uku-"+t);e.checked&&(c.UkuleleUtil.setFinalValue(n.controllerInstance,a,e.value),r&&r.call(o,n.alias,e))}),!0)}Object.defineProperty(t,"__esModule",{value:!0});var c=n(0),p=n(8),f=n(2);t.elementChangedBinder=r}])});
//# sourceMappingURL=uku.js.map